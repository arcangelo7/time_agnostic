<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="923px" preserveAspectRatio="none" style="width:619px;height:923px;background:transparent;" version="1.1" viewBox="0 0 619 923" width="619px" zoomAndPan="magnify"><defs><filter height="300%" id="f1pr3xpudop32j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1pr3xpudop32j)" height="272.2969" style="stroke:#000000;stroke-width:2.0;" width="346.5" x="40.5" y="430.7734"/><rect fill="#FFFFFF" filter="url(#f1pr3xpudop32j)" height="239.9453" style="stroke:#000000;stroke-width:2.0;" width="326.5" x="50.5" y="456.125"/><rect fill="#FFFFFF" filter="url(#f1pr3xpudop32j)" height="120.8906" style="stroke:#000000;stroke-width:2.0;" width="306.5" x="60.5" y="568.1797"/><rect fill="#FFFFFF" height="59.1875" style="stroke:none;stroke-width:1.0;" width="306.5" x="60.5" y="629.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="22" x2="22" y1="89.6094" y2="838.125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="123.5" x2="123.5" y1="89.6094" y2="838.125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="363.5" x2="363.5" y1="89.6094" y2="838.125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="439.5" x2="439.5" y1="89.6094" y2="838.125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="525.5" x2="525.5" y1="89.6094" y2="838.125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="594.5" x2="594.5" y1="89.6094" y2="838.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="5" y="86.5332">user</text><ellipse cx="22" cy="15" fill="#FEFECE" filter="url(#f1pr3xpudop32j)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M22,23 L22,50 M9,31 L35,31 M22,50 L9,65 M22,50 L35,65 " fill="none" filter="url(#f1pr3xpudop32j)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="5" y="851.6582">user</text><ellipse cx="22" cy="864.7344" fill="#FEFECE" filter="url(#f1pr3xpudop32j)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M22,872.7344 L22,899.7344 M9,880.7344 L35,880.7344 M22,899.7344 L9,914.7344 M22,899.7344 L35,914.7344 " fill="none" filter="url(#f1pr3xpudop32j)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1pr3xpudop32j)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="103" x="70.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="77.5" y="74.5332">AgnosticEntity</text><rect fill="#FEFECE" filter="url(#f1pr3xpudop32j)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="103" x="70.5" y="837.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="77.5" y="858.6582">AgnosticEntity</text><rect fill="#FEFECE" filter="url(#f1pr3xpudop32j)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="55" x="334.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="341.5" y="74.5332">Sparql</text><rect fill="#FEFECE" filter="url(#f1pr3xpudop32j)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="55" x="334.5" y="837.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="341.5" y="858.6582">Sparql</text><rect fill="#FEFECE" filter="url(#f1pr3xpudop32j)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="68" x="403.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="410.5" y="74.5332">datetime</text><rect fill="#FEFECE" filter="url(#f1pr3xpudop32j)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="68" x="403.5" y="837.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="410.5" y="858.6582">datetime</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="485.5" y="86.5332">provenance</text><path d="M508,36 C508,26 526,26 526,26 C526,26 544,26 544,36 L544,62 C544,72 526,72 526,72 C526,72 508,72 508,62 L508,36 " fill="#FEFECE" filter="url(#f1pr3xpudop32j)" style="stroke:#000000;stroke-width:1.5;"/><path d="M508,36 C508,46 526,46 526,46 C526,46 544,46 544,36 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="485.5" y="851.6582">provenance</text><path d="M508,864.7344 C508,854.7344 526,854.7344 526,854.7344 C526,854.7344 544,854.7344 544,864.7344 L544,890.7344 C544,900.7344 526,900.7344 526,900.7344 C526,900.7344 508,900.7344 508,890.7344 L508,864.7344 " fill="#FEFECE" filter="url(#f1pr3xpudop32j)" style="stroke:#000000;stroke-width:1.5;"/><path d="M508,864.7344 C508,874.7344 526,874.7344 526,874.7344 C526,874.7344 544,874.7344 544,864.7344 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="577.5" y="86.5332">data</text><path d="M576.5,36 C576.5,26 594.5,26 594.5,26 C594.5,26 612.5,26 612.5,36 L612.5,62 C612.5,72 594.5,72 594.5,72 C594.5,72 576.5,72 576.5,62 L576.5,36 " fill="#FEFECE" filter="url(#f1pr3xpudop32j)" style="stroke:#000000;stroke-width:1.5;"/><path d="M576.5,36 C576.5,46 594.5,46 594.5,46 C594.5,46 612.5,46 612.5,36 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="577.5" y="851.6582">data</text><path d="M576.5,864.7344 C576.5,854.7344 594.5,854.7344 594.5,854.7344 C594.5,854.7344 612.5,854.7344 612.5,864.7344 L612.5,890.7344 C612.5,900.7344 594.5,900.7344 594.5,900.7344 C594.5,900.7344 576.5,900.7344 576.5,890.7344 L576.5,864.7344 " fill="#FEFECE" filter="url(#f1pr3xpudop32j)" style="stroke:#000000;stroke-width:1.5;"/><path d="M576.5,864.7344 C576.5,874.7344 594.5,874.7344 594.5,874.7344 C594.5,874.7344 612.5,874.7344 612.5,864.7344 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><polygon fill="#A80036" points="112,117.9609,122,121.9609,112,125.9609,116,121.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="22" x2="118" y1="121.9609" y2="121.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="29" y="117.1045">get_history()</text><polygon fill="#A80036" points="352,148.3125,362,152.3125,352,156.3125,356,152.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="124" x2="358" y1="152.3125" y2="152.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="131" y="147.4561">get_entity_current_state()</text><polygon fill="#A80036" points="514,178.6641,524,182.6641,514,186.6641,518,182.6641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="364" x2="520" y1="182.6641" y2="182.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="371" y="177.8076">_query_provenance()</text><polygon fill="#A80036" points="375,192.6641,365,196.6641,375,200.6641,371,196.6641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="369" x2="525" y1="196.6641" y2="196.6641"/><polygon fill="#A80036" points="582.5,223.0156,592.5,227.0156,582.5,231.0156,586.5,227.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="364" x2="588.5" y1="227.0156" y2="227.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="371" y="222.1592">_query_dataset()</text><polygon fill="#A80036" points="375,237.0156,365,241.0156,375,245.0156,371,241.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="369" x2="593.5" y1="241.0156" y2="241.0156"/><polygon fill="#A80036" points="135,267.3672,125,271.3672,135,275.3672,131,271.3672" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="129" x2="363" y1="271.3672" y2="271.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="141" y="266.5107">entity_current_state</text><line style="stroke:#A80036;stroke-width:1.0;" x1="124" x2="166" y1="301.7188" y2="301.7188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="166" x2="166" y1="301.7188" y2="314.7188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="125" x2="166" y1="314.7188" y2="314.7188"/><polygon fill="#A80036" points="135,310.7188,125,314.7188,135,318.7188,131,314.7188" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="131" y="296.8623">_get_old_graphs()</text><polygon fill="#A80036" points="427.5,341.0703,437.5,345.0703,427.5,349.0703,431.5,345.0703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="124" x2="433.5" y1="345.0703" y2="345.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="131" y="340.2139">_convert_to_datetime()</text><polygon fill="#A80036" points="135,371.4219,125,375.4219,135,379.4219,131,375.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="129" x2="438.5" y1="375.4219" y2="375.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="141" y="370.5654">ordered_data</text><path d="M129,388.4219 L129,414.4219 L357,414.4219 L357,398.4219 L347,388.4219 L129,388.4219 " fill="#FBFB77" filter="url(#f1pr3xpudop32j)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M347,388.4219 L347,398.4219 L357,398.4219 L347,388.4219 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="135" y="406.917">data are sorted from present to past</text><path d="M40.5,430.7734 L113.5,430.7734 L113.5,438.7734 L103.5,448.7734 L40.5,448.7734 L40.5,430.7734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="272.2969" style="stroke:#000000;stroke-width:2.0;" width="346.5" x="40.5" y="430.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="55.5" y="445.2686">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82" x="128.5" y="444.1924">[ordered_data]</text><path d="M50.5,456.125 L111.5,456.125 L111.5,464.125 L101.5,474.125 L50.5,474.125 L50.5,456.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="239.9453" style="stroke:#000000;stroke-width:2.0;" width="326.5" x="50.5" y="456.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="65.5" y="470.6201">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="56" x="126.5" y="469.5439">[index &gt; 0]</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124" x2="166" y1="496.8281" y2="496.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="166" x2="166" y1="496.8281" y2="509.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="125" x2="166" y1="509.8281" y2="509.8281"/><polygon fill="#A80036" points="135,505.8281,125,509.8281,135,513.8281,131,509.8281" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="131" y="491.9717">copy graph at index - 1</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124" x2="166" y1="540.1797" y2="540.1797"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="166" x2="166" y1="540.1797" y2="553.1797"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="125" x2="166" y1="553.1797" y2="553.1797"/><polygon fill="#A80036" points="135,549.1797,125,553.1797,135,557.1797,131,553.1797" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="131" y="535.3232">get update queries of graph at index - 1</text><path d="M60.5,568.1797 L121.5,568.1797 L121.5,576.1797 L111.5,586.1797 L60.5,586.1797 L60.5,568.1797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="120.8906" style="stroke:#000000;stroke-width:2.0;" width="306.5" x="60.5" y="568.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="75.5" y="582.6748">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="186" x="136.5" y="581.5986">[snapshot_update_query is None]</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124" x2="166" y1="608.8828" y2="608.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="166" x2="166" y1="608.8828" y2="621.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="125" x2="166" y1="621.8828" y2="621.8828"/><polygon fill="#A80036" points="135,617.8828,125,621.8828,135,625.8828,131,621.8828" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="131" y="604.0264">graph at index = graph at index - 1</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="60.5" x2="367" y1="630.8828" y2="630.8828"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="142" x="65.5" y="642.3018">[snapshot_update_query]</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124" x2="166" y1="668.0703" y2="668.0703"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="166" x2="166" y1="668.0703" y2="681.0703"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="125" x2="166" y1="681.0703" y2="681.0703"/><polygon fill="#A80036" points="135,677.0703,125,681.0703,135,685.0703,131,681.0703" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="131" y="663.2139">graph at index = graph at index - 1 + Δ</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124" x2="166" y1="732.4219" y2="732.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="166" x2="166" y1="732.4219" y2="745.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="125" x2="166" y1="745.4219" y2="745.4219"/><polygon fill="#A80036" points="135,741.4219,125,745.4219,135,749.4219,131,745.4219" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="131" y="727.5654">remove provenance triples</text><polygon fill="#A80036" points="427.5,771.7734,437.5,775.7734,427.5,779.7734,431.5,775.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="124" x2="433.5" y1="775.7734" y2="775.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="131" y="770.917">strftime("%Y-%m-%dT%H:%M:%S")</text><polygon fill="#A80036" points="135,785.7734,125,789.7734,135,793.7734,131,789.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="129" x2="438.5" y1="789.7734" y2="789.7734"/><polygon fill="#A80036" points="33,816.125,23,820.125,33,824.125,29,820.125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="27" x2="123" y1="820.125" y2="820.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="39" y="815.2686">entity_history</text><!--MD5=[82bc7e1b3dac16d92d46984a037eda74]
@startuml
actor user
participant AgnosticEntity 
participant Sparql 
participant datetime
database provenance
database data

user -> AgnosticEntity: get_history()
AgnosticEntity -> Sparql: get_entity_current_state()
Sparql -> provenance: _query_provenance()
return
Sparql -> data: _query_dataset()
return
Sparql -> AgnosticEntity: entity_current_state
AgnosticEntity -> AgnosticEntity: _get_old_graphs()
AgnosticEntity -> datetime: _convert_to_datetime()
datetime -> AgnosticEntity: ordered_data
note right AgnosticEntity
data are sorted from present to past
end note
loop ordered_data
    alt index > 0
        AgnosticEntity - -> AgnosticEntity: copy graph at index - 1
        AgnosticEntity - -> AgnosticEntity: get update queries of graph at index - 1
        alt snapshot_update_query is None
            AgnosticEntity - -> AgnosticEntity: graph at index = graph at index - 1
        else snapshot_update_query
            AgnosticEntity - -> AgnosticEntity: graph at index = graph at index - 1 + Δ
        end   
    end
end
AgnosticEntity - -> AgnosticEntity: remove provenance triples 
AgnosticEntity -> datetime: strftime("%Y-%m-%dT%H:%M:%S")
return
AgnosticEntity -> user: entity_history
@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CEST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: it
Country: IT
--></g></svg>