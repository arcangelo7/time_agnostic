<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time agnostic</title>
    <link type="text/css" href="./css/neumorphism.css" rel="stylesheet">
    <link type="text/css" href="./css/custom.css" rel="stylesheet">
    <!-- Fontawesome -->
    <link type="text/css" href="./vendor/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
</head>

<body>
    <header class="header-global">
        <div class="nav-wrapper container position-relative">
            <ul class="nav nav-pills nav-fill flex-column flex-sm-row">
                <li class="nav-item">
                    <a class="nav-link mb-sm-3 mb-md-0 active" href="#">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link mb-sm-3 mb-md-0" href="#next-meet">Prossimo incontro</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link mb-sm-3 mb-md-0" href="#past-meet">Archivio</a>
                </li>
            </ul>
        </div>
    </header>

    <main>
        <!-- Hero -->
        <section class="section section bg-soft pb-5 overflow-hidden z-2">
            <div class="container z-2">
                <div class="row justify-content-center text-center pt-6">
                    <div class="col-lg-8 col-xl-8">
                        <h1 class="display-2 mb-3">Time agnostic</h1>
                        <p class="lead px-md-6 mb-5">Diario di bordo del tirocinio presso <a
                                href="http://opencitations.net/" alt="Link to the OpenCitations main page"
                                target="_blank"><span class="oc-purple">Open</span><span
                                    class="oc-blue">Citations</span></a>.</p>
                        <div class="d-flex flex-column flex-wrap flex-md-row justify-content-md-center mb-5">
                            <a href="https://github.com/arcangelo7/time_agnostic" target="_blank"
                                class="btn btn-primary mb-3 mb-lg-0 mr-3" alt="Link to the repository"><i
                                    class="fab fa-github mr-2"></i>Vai
                                alla repository</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="section pb-5" id="next-meet">
            <div class="container">
                <div class="row justify-content-center mb-5">
                    <h2>Prossimo incontro (10/03/2020)</h2>
                </div>
                <h3>Cosa ho fatto</h3>
                <ul>
                    <li>Ho letto:</li>
                    <ul>
                        <li>Peroni, S., Shotton, D., Vitali, F. (2016). <em>A document-inspired way for tracking changes
                                of RDF data</em>. <a href="https://w3id.org/oc/paper/occ-driftalod2016.html"
                                alt="Link to the paper">https://w3id.org/oc/paper/occ-driftalod2016.html</a>. </li>
                        <li>Daquino, M., Peroni, S., Shotton D. (2020). <em>The OpenCitations Data Model</em>. <a
                                href="https://figshare.com/articles/online_resource/Metadata_for_the_OpenCitations_Corpus/3443876/7"
                                alt="Link to the OpenCitations Data Model documentation">https://figshare.com/articles/online_resource/Metadata_for_the_OpenCitations_Corpus/3443876/7</a>
                        </li>
                        <li>Documentazione delle seguenti librerie e API: <em>Crossref REST API</em>, <em>REST API for
                                COCI</em>, <em>oc_ocdm</em>.</li>
                        <li>Ho sfogliato il lavoro fin qui svolto da Arianna Moretti.</li>
                    </ul>
                    <li>Ho scritto il seguente codice con lo scopo di comprendere il funzionamento di tutte le librerie e API su menzionate, nonché di produrre output utili in vista della realizzazione del dataset su "Scientometrics": <a href="https://github.com/arcangelo7/time_agnostic/blob/main/scientometrics.py" target="_blank" alt="Link to scientometrics.py">scientometrics.py</a>.</li>
                    <div class="col-12 mt-3 mb-4">
                        <div class="card bg-primary shadow-inset border-light">
                            <div class="card-body p-5"> 
                                <pre>
                                    <code class="prettyprint">
import requests, requests_cache, json
from oc_ocdm.graph import GraphSet
from oc_ocdm.storer import Storer
from oc_ocdm.support import create_date
from rdflib import URIRef


def get_journal_data(journal_issn, i_am_polite):
    journal_data = requests.get(url = f'http://api.crossref.org/journals/{{{journal_issn}}}/works?mailto={i_am_polite}')
    journal_data_json = journal_data.json()
    return journal_data_json


def get_all_references_from_journal(journal_data_json):
    journal_data_items = journal_data_json["message"]["items"]
    all_references = list()
    for item in journal_data_items:
        references = requests.get(url = f'https://w3id.org/oc/index/coci/api/v1/references/{item["DOI"]}?format=json')
        references_json = references.json()
        all_references.append(references_json)
    return all_references


def update_graph(journal_data_json, graphset):
    journal_data_items = journal_data_json["message"]["items"]
    for item in journal_data_items:
        try:
            # a volte gli articoli ritornati da crossref non hanno il campo "author". È molto raro, ma accade.
            responsible_agent_name = item["author"][0]["given"] + " " + item["author"][0]["family"]
            responsible_agent = scientometrics_graphset.add_ra(responsible_agent_name)
            responsible_agent.has_given_name(item["author"][0]["given"])
            responsible_agent.has_family_name(item["author"][0]["family"])
            # non ho ancora gestito il problema dell'omonimia, ma sono consapevole che vada gestito
            scientometrics_br = scientometrics_graphset.add_br(responsible_agent)
            scientometrics_br.has_title(item["title"][0])
            iso_date_string = create_date([item["published-print"]["date-parts"][0][0]])
            scientometrics_br.has_pub_date(iso_date_string)
        except KeyError:
            pass
    graphset.commit_changes()


# Crossref test
requests_cache.install_cache('cache')
issn_web_scientometrics = "1588-2861"
my_mail = "arcangelo.massari@studio.unibo.it"
journal_data = get_journal_data(issn_web_scientometrics, my_mail)

# REST API for COCI test
all_references = get_all_references_from_journal(journal_data)

# oc_ocdm test
scientometrics_graphset = GraphSet("https://arcangelo7.github.io/time_agnostic/")
update_graph(journal_data, scientometrics_graphset)

# Retrieved data dump
with open('data/scientometrics.json', 'w') as outfile:
    json.dump(journal_data, outfile)
with open('data/references.json', 'w') as outfile:
    json.dump(all_references, outfile)
storer = Storer(scientometrics_graphset)
storer.store_graphs_in_file("data/graph.json", "./")                      
                                    </code>
                                </pre>
                            </div>
                        </div>
                    </div>
                    <li>Ho ottenuto in output tre file json:</li>
                    <ul>
                        <li>Una lista di 20 lavori (articoli, libri, atti di convegni, etc) presenti nella rivista "Scientometrics", con relativi metadati: <a href="https://github.com/arcangelo7/time_agnostic/blob/main/data/scientometrics.json" alt="Link to scientometrics.json" target="_blank">scientometrics.json</a>.</li>
                        <li>I dati citazionali per tutti i riferimenti in uscita relativi ai DOI di 20 lavori presenti nella rivista "Scientometrics": <a href="https://github.com/arcangelo7/time_agnostic/blob/main/data/references.json" target="_blank" alt="Link to references.json">references.json</a>.</li>
                        <li>Una lista di grafi conformi a OCDM v2.0.1 contenente 20 entità di tipo BibliographicResource relative a 20 lavori presenti in "Scientometrics", con metadati relativi a titolo e data di pubblicazione: <a href="https://github.com/arcangelo7/time_agnostic/blob/main/data/graph.json" target="_blank" alt="Link to the graph">graph.json</a>.</li>
                    </ul>
                </ul>
                <h3>Cosa non ho capito</h3>
                <ul>
                    <li>Non posso accedere a <em>The OpenCitations Data Model</em> su SpringerLink (<a href="https://link.springer.com/chapter/10.1007%2F978-3-030-62466-8_28" alt="Link to the OpenCitations Data Model docuemntation on Springer" target="_blank">https://link.springer.com/chapter/10.1007%2F978-3-030-62466-8_28</a>) neanche tramite proxy Unibo. È diverso rispetto a quello pubblicato su figshare? (<a href="https://figshare.com/articles/online_resource/Metadata_for_the_OpenCitations_Corpus/3443876/7" alt="Link to the OpenCitations Data Model documentation on Figshare">https://figshare.com/articles/online_resource/Metadata_for_the_OpenCitations_Corpus/3443876/7</a>)</li>
                    <li>Gli articoli di "Scientometrics" ritornati tramite GET a http://api.crossref.org/journals/{1588-2861}/works, dove 1588-2861 è l'ISSN web di "Scientometrics", sono 20 alla volta. Tramite il parametro rows è possibile aumentare questo numero a massimo 1000. Come faccio a ritornarli tutti?</li>
                    <li>A quale ISSN di "Scientometrics" devo fare riferimento, quello web (1588-2861), quello stampa (0138-9130) o entrambi?</li>
                    <li>Per creare una nuova entità di qualunque tipo, sia essa una Bibliographic Resource o una Citation, occorre passare in input al metodo corrispondente il responsible agent. Ad esempio, <code class="prettyprint">scientometrics_graphset.add_br(responsible_agent)</code>. Dato che l'OCDM prevede il Responsible agent come tipo, credo ci si riferisca ad esso. Su questo ho due dubbi:
                        <ol>
                            <li>Nel grafo finale non vedo il collegamento tra i Responsible Agents e le corrispondenti Bibliographic Resources. Entrambi vengono indicati da un URL nella forma [dataset URL][entity dataset identifier] - ad esempio https://arcangelo7.github.io/time_agnostic/ra/6 - ma il grafo non riporta qual è la Bibliographic Resource corrispondente. Fa fede il numero? Ovvero il Responsible Agent 6 è responsabile della Bibliographic Resource 6?</li>
                            <li>Suggerimenti su come gestire le omonimie?</li>
                        </ol>
                    </li>
                </ul>
            </div>
        </section>

        <section class="section pb-5" id="past-meet">
            <div class="container">
                <div class="row justify-content-center mb-5">
                    <h2>Archivio</h2>
                </div>
                <div class="accordion shadow-soft rounded" id="accordionExample1">
                    <div class="card card-sm card-body bg-primary border-light mb-0">
                        <a href="#panel-1" data-target="#panel-1" class="accordion-panel-header" data-toggle="collapse"
                            role="button" aria-expanded="false" aria-controls="panel-1">
                            <span class="h6 mb-0 font-weight-bold">10/03/2021</span>
                            <span class="icon"><span class="fas fa-plus"></span></span>
                        </a>
                        <div class="collapse" id="panel-1">
                            <div class="pt-3">
                                <h3>Cosa ho fatto</h3>
                                <ul>
                                    <li>Ho letto:</li>
                                    <ul>
                                        <li>Peroni, S., Shotton, D., Vitali, F. (2016). <em>A document-inspired way for tracking changes
                                                of RDF data</em>. <a href="https://w3id.org/oc/paper/occ-driftalod2016.html"
                                                alt="Link to the paper">https://w3id.org/oc/paper/occ-driftalod2016.html</a>. </li>
                                        <li>Daquino, M., Peroni, S., Shotton D. (2020). <em>The OpenCitations Data Model</em>. <a
                                                href="https://figshare.com/articles/online_resource/Metadata_for_the_OpenCitations_Corpus/3443876/7"
                                                alt="Link to the OpenCitations Data Model documentation">https://figshare.com/articles/online_resource/Metadata_for_the_OpenCitations_Corpus/3443876/7</a>
                                        </li>
                                        <li>Documentazione delle seguenti librerie e API: <em>Crossref REST API</em>, <em>REST API for
                                                COCI</em>, <em>oc_ocdm</em>.</li>
                                        <li>Ho sfogliato il lavoro fin qui svolto da Arianna Moretti.</li>
                                    </ul>
                                    <li>Ho scritto il seguente codice con lo scopo di comprendere il funzionamento di tutte le librerie e API su menzionate, nonché di produrre output utili in vista della realizzazione del dataset su "Scientometrics": <a href="https://github.com/arcangelo7/time_agnostic/blob/main/scientometrics.py" target="_blank" alt="Link to scientometrics.py">scientometrics.py</a>.</li>
                                    <div class="col-12 mt-3 mb-4">
                                        <div class="card bg-primary shadow-inset border-light">
                                            <div class="card-body p-5"> 
                                                <pre>
                                                    <code class="prettyprint">
                import requests, requests_cache, json
                from oc_ocdm.graph import GraphSet
                from oc_ocdm.storer import Storer
                from oc_ocdm.support import create_date
                from rdflib import URIRef
                
                
                def get_journal_data(journal_issn, i_am_polite):
                    journal_data = requests.get(url = f'http://api.crossref.org/journals/{{{journal_issn}}}/works?mailto={i_am_polite}')
                    journal_data_json = journal_data.json()
                    return journal_data_json
                
                
                def get_all_references_from_journal(journal_data_json):
                    journal_data_items = journal_data_json["message"]["items"]
                    all_references = list()
                    for item in journal_data_items:
                        references = requests.get(url = f'https://w3id.org/oc/index/coci/api/v1/references/{item["DOI"]}?format=json')
                        references_json = references.json()
                        all_references.append(references_json)
                    return all_references
                
                
                def update_graph(journal_data_json, graphset):
                    journal_data_items = journal_data_json["message"]["items"]
                    for item in journal_data_items:
                        try:
                            # a volte gli articoli ritornati da crossref non hanno il campo "author". È molto raro, ma accade.
                            responsible_agent_name = item["author"][0]["given"] + " " + item["author"][0]["family"]
                            responsible_agent = scientometrics_graphset.add_ra(responsible_agent_name)
                            responsible_agent.has_given_name(item["author"][0]["given"])
                            responsible_agent.has_family_name(item["author"][0]["family"])
                            # non ho ancora gestito il problema dell'omonimia, ma sono consapevole che vada gestito
                            scientometrics_br = scientometrics_graphset.add_br(responsible_agent)
                            scientometrics_br.has_title(item["title"][0])
                            iso_date_string = create_date([item["published-print"]["date-parts"][0][0]])
                            scientometrics_br.has_pub_date(iso_date_string)
                        except KeyError:
                            pass
                    graphset.commit_changes()
                
                
                # Crossref test
                requests_cache.install_cache('cache')
                issn_web_scientometrics = "1588-2861"
                my_mail = "arcangelo.massari@studio.unibo.it"
                journal_data = get_journal_data(issn_web_scientometrics, my_mail)
                
                # REST API for COCI test
                all_references = get_all_references_from_journal(journal_data)
                
                # oc_ocdm test
                scientometrics_graphset = GraphSet("https://arcangelo7.github.io/time_agnostic/")
                update_graph(journal_data, scientometrics_graphset)
                
                # Retrieved data dump
                with open('data/scientometrics.json', 'w') as outfile:
                    json.dump(journal_data, outfile)
                with open('data/references.json', 'w') as outfile:
                    json.dump(all_references, outfile)
                storer = Storer(scientometrics_graphset)
                storer.store_graphs_in_file("data/graph.json", "./")                      
                                                    </code>
                                                </pre>
                                            </div>
                                        </div>
                                    </div>
                                    <li>Ho ottenuto in output tre file json:</li>
                                    <ul>
                                        <li>Una lista di 20 lavori (articoli, libri, atti di convegni, etc) presenti nella rivista "Scientometrics", con relativi metadati: <a href="https://github.com/arcangelo7/time_agnostic/blob/main/data/scientometrics.json" alt="Link to scientometrics.json" target="_blank">scientometrics.json</a>.</li>
                                        <li>I dati citazionali per tutti i riferimenti in uscita relativi ai DOI di 20 lavori presenti nella rivista "Scientometrics": <a href="https://github.com/arcangelo7/time_agnostic/blob/main/data/references.json" target="_blank" alt="Link to references.json">references.json</a>.</li>
                                        <li>Una lista di grafi conformi a OCDM v2.0.1 contenente 20 entità di tipo BibliographicResource relative a 20 lavori presenti in "Scientometrics", con metadati relativi a titolo e data di pubblicazione: <a href="https://github.com/arcangelo7/time_agnostic/blob/main/data/graph.json" target="_blank" alt="Link to the graph">graph.json</a>.</li>
                                    </ul>
                                </ul>
                                <h3>Cosa non ho capito</h3>
                                <ul>
                                    <li>Non posso accedere a <em>The OpenCitations Data Model</em> su SpringerLink (<a href="https://link.springer.com/chapter/10.1007%2F978-3-030-62466-8_28" alt="Link to the OpenCitations Data Model docuemntation on Springer" target="_blank">https://link.springer.com/chapter/10.1007%2F978-3-030-62466-8_28</a>) neanche tramite proxy Unibo. È diverso rispetto a quello pubblicato su figshare? (<a href="https://figshare.com/articles/online_resource/Metadata_for_the_OpenCitations_Corpus/3443876/7" alt="Link to the OpenCitations Data Model documentation on Figshare">https://figshare.com/articles/online_resource/Metadata_for_the_OpenCitations_Corpus/3443876/7</a>)</li>
                                    <li>Gli articoli di "Scientometrics" ritornati tramite GET a http://api.crossref.org/journals/{1588-2861}/works, dove 1588-2861 è l'ISSN web di "Scientometrics", sono 20 alla volta. Tramite il parametro rows è possibile aumentare questo numero a massimo 1000. Come faccio a ritornarli tutti?</li>
                                    <li>A quale ISSN di "Scientometrics" devo fare riferimento, quello web (1588-2861), quello stampa (0138-9130) o entrambi?</li>
                                    <li>Per creare una nuova entità di qualunque tipo, sia essa una Bibliographic Resource o una Citation, occorre passare in input al metodo corrispondente il responsible agent. Ad esempio, <code class="prettyprint">scientometrics_graphset.add_br(responsible_agent)</code>. Dato che l'OCDM prevede il Responsible agent come tipo, credo ci si riferisca ad esso. Su questo ho due dubbi:
                                        <ol>
                                            <li>Nel grafo finale non vedo il collegamento tra i Responsible Agents e le corrispondenti Bibliographic Resources. Entrambi vengono indicati da un URL nella forma [dataset URL][entity dataset identifier] - ad esempio https://arcangelo7.github.io/time_agnostic/ra/6 - ma il grafo non riporta qual è la Bibliographic Resource corrispondente. Fa fede il numero? Ovvero il Responsible Agent 6 è responsabile della Bibliographic Resource 6?</li>
                                            <li>Suggerimenti su come gestire le omonimie?</li>
                                        </ol>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card card-sm card-body bg-primary border-light mb-0">
                        <a href="#panel-2" data-target="#panel-2" class="accordion-panel-header" data-toggle="collapse"
                            role="button" aria-expanded="false" aria-controls="panel-1">
                            <span class="h6 mb-0 font-weight-bold">17/03/2021</span>
                            <span class="icon"><span class="fas fa-plus"></span></span>
                        </a>
                        <div class="collapse" id="panel-2">
                            <div class="pt-3">
                                <p class="mb-0"></p>
                            </div>
                        </div>
                    </div>
                    <div class="card card-sm card-body bg-primary border-light">
                        <a href="#panel-3" data-target="#panel-3" class="accordion-panel-header" data-toggle="collapse"
                            role="button" aria-expanded="false" aria-controls="panel-1">
                            <span class="h6 mb-0 font-weight-bold">24/03/2021</span>
                            <span class="icon"><span class="fas fa-plus"></span></span>
                        </a>
                        <div class="collapse" id="panel-3">
                            <div class="pt-3">
                                <p class="mb-0"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Core -->
    <script src="./vendor/jquery/dist/jquery.min.js"></script>
    <script src="./vendor/popper.js/dist/umd/popper.min.js"></script>
    <script src="./vendor/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="./vendor/headroom.js/dist/headroom.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>

    <!-- Vendor JS -->
    <script src="./vendor/onscreen/dist/on-screen.umd.min.js"></script>
    <script src="./vendor/nouislider/distribute/nouislider.min.js"></script>
    <script src="./vendor/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
    <script src="./vendor/waypoints/lib/jquery.waypoints.min.js"></script>
    <script src="./vendor/jarallax/dist/jarallax.min.js"></script>
    <script src="./vendor/jquery.counterup/jquery.counterup.min.js"></script>
    <script src="./vendor/jquery-countdown/dist/jquery.countdown.min.js"></script>
    <script src="./vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
    <script src="./vendor/prismjs/prism.js"></script>
    <!-- Neumorphism JS -->
    <script src="./assets/js/neumorphism.js"></script>
</body>

</html>